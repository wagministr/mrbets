# üé• YouTube + Whisper Separation Strategy

## –ü—Ä–æ–±–ª–µ–º–∞

YouTube Fetcher —Å Whisper —Ç—Ä–µ–±—É–µ—Ç —Ç—è–∂–µ–ª—ã–µ ML –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- `yt-dlp` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ
- `openai-whisper` –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –∞—É–¥–∏–æ
- CUDA/cuDNN –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –Ω–∞ GPU
- –ë–æ–ª—å—à–æ–π –æ–±—ä–µ–º –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

–≠—Ç–æ –¥–µ–ª–∞–µ—Ç Docker –æ–±—Ä–∞–∑ backend –æ—á–µ–Ω—å —Ç—è–∂–µ–ª—ã–º –∏ –º–µ–¥–ª–µ–Ω–Ω—ã–º –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

## –†–µ—à–µ–Ω–∏–µ

YouTube + Whisper –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –Ω–∞ **–æ—Ç–¥–µ–ª—å–Ω–æ–µ –∂–µ–ª–µ–∑–æ** —Å GPU –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Backend       ‚îÇ    ‚îÇ   YouTube Worker ‚îÇ    ‚îÇ   Main Backend  ‚îÇ
‚îÇ   (–æ—Å–Ω–æ–≤–Ω–æ–π)    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   (–æ—Ç–¥–µ–ª—å–Ω—ã–π)    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   (Redis)       ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                  ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ ‚Ä¢ Twitter API   ‚îÇ    ‚îÇ ‚Ä¢ yt-dlp         ‚îÇ    ‚îÇ ‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞     ‚îÇ
‚îÇ ‚Ä¢ Football API  ‚îÇ    ‚îÇ ‚Ä¢ Whisper        ‚îÇ    ‚îÇ   —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤   ‚îÇ
‚îÇ ‚Ä¢ News Scraping ‚îÇ    ‚îÇ ‚Ä¢ GPU/CUDA       ‚îÇ    ‚îÇ ‚Ä¢ –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è  ‚îÇ
‚îÇ ‚Ä¢ RSS Feeds     ‚îÇ    ‚îÇ ‚Ä¢ –õ–æ–∫–∞–ª—å–Ω–æ–µ      ‚îÇ    ‚îÇ ‚Ä¢ –•—Ä–∞–Ω–µ–Ω–∏–µ      ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ   —Ö—Ä–∞–Ω–µ–Ω–∏–µ       ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –£–¥–∞–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –§–∞–π–ª—ã
- ‚ùå `backend/fetchers/youtube_fetcher.py` - —É–¥–∞–ª–µ–Ω
- ‚ùå YouTube –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `requirements.txt`

### 2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
# –£–¥–∞–ª–µ–Ω–æ –∏–∑ requirements.txt:
# yt-dlp>=2024.1.19
# openai-whisper>=20231117
```

### 3. Environment Variables
```bash
# –£–¥–∞–ª–µ–Ω–æ –∏–∑ .env:
# YOUTUBE_API_KEY
# WHISPER_MODEL
# TEMP_AUDIO_DIR
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º YouTube Worker

### –ß–µ—Ä–µ–∑ Redis Streams

**YouTube Worker** (–æ—Ç–¥–µ–ª—å–Ω–æ–µ –∂–µ–ª–µ–∑–æ) –±—É–¥–µ—Ç:
1. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å YouTube –∫–∞–Ω–∞–ª—ã
2. –°–∫–∞—á–∏–≤–∞—Ç—å –Ω–æ–≤—ã–µ –≤–∏–¥–µ–æ —Å yt-dlp
3. –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞—Ç—å –∞—É–¥–∏–æ —Å Whisper
4. –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Redis Stream

**Main Backend** –±—É–¥–µ—Ç:
1. –ß–∏—Ç–∞—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –∏–∑ Redis Stream
2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ LLM Content Analyzer
3. –°–æ–∑–¥–∞–≤–∞—Ç—å –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ embeddings
4. –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ Pinecone/Supabase

### –ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Redis

```json
{
  "event_type": "youtube_transcript",
  "source": "youtube",
  "match_id": "12345", 
  "timestamp": 1701234567,
  "payload": {
    "video_id": "abc123",
    "channel_name": "Sky Sports",
    "title": "Manchester United vs Liverpool Preview",
    "transcript": "–í —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–º –º–∞—Ç—á–µ...",
    "duration": 1200,
    "url": "https://youtube.com/watch?v=abc123",
    "published_at": "2024-01-15T10:00:00Z"
  },
  "meta": {
    "whisper_model": "medium",
    "confidence": 0.89,
    "language": "en",
    "processed_at": "2024-01-15T10:05:00Z"
  }
}
```

## Deployment Strategy

### Backend (–æ—Å–Ω–æ–≤–Ω–æ–π)
- üöÄ –ë—ã—Å—Ç—Ä—ã–π deployment –±–µ–∑ ML –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- üê≥ –õ–µ–≥–∫–∏–π Docker –æ–±—Ä–∞–∑ (~500MB –≤–º–µ—Å—Ç–æ ~5GB)
- ‚ö° –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ dependencies (2-3 –º–∏–Ω—É—Ç—ã –≤–º–µ—Å—Ç–æ 30-60)

### YouTube Worker (–æ—Ç–¥–µ–ª—å–Ω–æ)
- üñ•Ô∏è –ó–∞–ø—É—Å–∫ –Ω–∞ –∂–µ–ª–µ–∑–µ —Å GPU (RTX/Tesla)
- üîÑ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ (–∫–∞–∂–¥—ã–µ 6-12 —á–∞—Å–æ–≤)
- üíæ –õ–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤
- üß† Whisper model loading –≤ –ø–∞–º—è—Ç—å –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Backend Logs
```bash
docker-compose logs backend | grep youtube
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å: "YouTube processing delegated to separate worker"
```

### YouTube Worker Logs (–æ—Ç–¥–µ–ª—å–Ω–æ)
```bash
tail -f youtube_worker.log
# 2024-01-15 10:00:00 - Processing Sky Sports channel
# 2024-01-15 10:02:30 - Downloaded video abc123 (1.2GB)
# 2024-01-15 10:05:45 - Whisper transcription completed (confidence: 0.89)
# 2024-01-15 10:06:00 - Sent to Redis stream: stream:raw_events
```

## –ë—É–¥—É—â–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–ö–æ–≥–¥–∞ YouTube Worker –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤:

1. **–°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: `mrbets-youtube-worker`
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron –∑–∞–¥–∞—á—É**: –Ω–∞ GPU —Å–µ—Ä–≤–µ—Ä–µ
3. **–ü–æ–¥–∫–ª—é—á–∏—Ç—å Redis**: —Ç–æ—Ç –∂–µ REDIS_URL —á—Ç–æ –∏ main backend
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: —á–µ—Ä–µ–∑ —Ç–æ—Ç –∂–µ Redis Stream

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ë—ã—Å—Ç—Ä—ã–π deployment** –æ—Å–Ω–æ–≤–Ω–æ–≥–æ backend  
‚úÖ **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** ML –æ—Ç –≤–µ–±-—Å–µ—Ä–≤–∏—Å–∞  
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ GPU workers  
‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - —Å–±–æ–π YouTube –Ω–µ –ª–æ–º–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å  
‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** - GPU —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ  

## –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

‚ö†Ô∏è **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å** —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤—É–º—è —Å–∏—Å—Ç–µ–º–∞–º–∏  
‚ö†Ô∏è **–ó–∞–¥–µ—Ä–∂–∫–∞** –º–µ–∂–¥—É –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –≤–∏–¥–µ–æ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π  
‚ö†Ô∏è **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∂–µ–ª–µ–∑–æ** —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è GPU  

---

**–ò—Ç–æ–≥**: –≠—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ—Ä–∂–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π backend –ª–µ–≥–∫–∏–º –∏ –±—ã—Å—Ç—Ä—ã–º, 
–ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —Ç–µ—Ä—è—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å YouTube –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ –º–æ—â–Ω–æ–º –∂–µ–ª–µ–∑–µ. 